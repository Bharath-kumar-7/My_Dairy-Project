<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bootstrap demo</title>
    <link rel="stylesheet" href="./FeedPage.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@300..700&display=swap" rel="stylesheet">
</head>

<body>
    <div class="text-end p-2">
        <a href="Post.html" class="btn btn-primary w-25">New Post</a>
        <a href="Login.html" class="btn btn-danger w-25">Logout</a>
    </div>

    <div class="allPosts">
        <div class="Post">
            <h1>First Day at Clz</h1>
            <p>Lorem ipsum dolor, sit amet consectetur
                adipisicing elit. Qui explicabo velit ipsam minus quasi, magni
                molestias doloremque iusto expedita eum.
                <br>
                Lorem ipsum dolor sit amet consectetur adipisicing elit. Iste, recusandae? Blanditiis, porro! Ipsa culpa
                dolore iusto laudantium distinctio voluptas? Culpa dolorum consectetur maxime, obcaecati omnis error
                distinctio at aspernatur dignissimos itaque. Sapiente neque pariatur consequatur laborum porro ratione
                itaque inventore blanditiis. Nisi quo quibusdam quia consequuntur ad dicta ullam deleniti.
            </p>
            <a class="btn viewPostButton text-white" href="DedicatedPage.html">View Post</a>
        </div>

        <div class="Post">
            <h1>First Day at Clz</h1>
            <p>Lorem ipsum dolor, sit amet consectetur
                adipisicing elit. Qui explicabo velit ipsam minus quasi, magni
                molestias doloremque iusto expedita eum.
                <br>
                Lorem ipsum dolor sit amet consectetur adipisicing elit. Iste, recusandae? Blanditiis, porro! Ipsa culpa
                dolore iusto laudantium distinctio voluptas? Culpa dolorum consectetur maxime, obcaecati omnis error
                distinctio at aspernatur dignissimos itaque. Sapiente neque pariatur consequatur laborum porro ratione
                itaque inventore blanditiis. Nisi quo quibusdam quia consequuntur ad dicta ullam deleniti.
            </p>
            <button class="btn viewPostButton text-white">View Post</button>
        </div>

        <div class="Post">
            <h1>First Day at Clz</h1>
            <p>Lorem ipsum dolor, sit amet consectetur
                adipisicing elit. Qui explicabo velit ipsam minus quasi, magni
                molestias doloremque iusto expedita eum.
                <br>
                Lorem ipsum dolor sit amet consectetur adipisicing elit. Iste, recusandae? Blanditiis, porro! Ipsa culpa
                dolore iusto laudantium distinctio voluptas? Culpa dolorum consectetur maxime, obcaecati omnis error
                distinctio at aspernatur dignissimos itaque. Sapiente neque pariatur consequatur laborum porro ratione
                itaque inventore blanditiis. Nisi quo quibusdam quia consequuntur ad dicta ullam deleniti.
            </p>
            <button class="btn viewPostButton text-white">View Post</button>
        </div>



    </div>


    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
        integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.min.js"
        integrity="sha384-RuyvpeZCxMJCqVUGFI0Do1mQrods/hhxYlcVfGPOfQtPJh0JCw12tUAZ/Mv10S7D"
        crossorigin="anonymous"></script>
</body>

</html>
<script>
document.addEventListener("DOMContentLoaded", async () => {
    const postsContainer = document.querySelector(".allPosts");
    postsContainer.innerHTML = "<p>Loading your posts...</p>";

    const userID = localStorage.getItem("userID");

    if (!userID) {
        postsContainer.innerHTML = "<p class='text-danger'>Please log in to view your posts.</p>";
        return;
    }

    try {
        const response = await fetch(`http://localhost:3000/getMyposts?userID=${userID}`);
        if (!response.ok) throw new Error("Failed to load posts");
        const posts = await response.json();

        if (posts.length === 0) {
            postsContainer.innerHTML = "<h4 class='text-center text-muted'>You haven't posted anything yet.</h4>";
            return;
        }

        postsContainer.innerHTML = posts.map(post => `
            <div class="Post">
                <h2>${post.postTitle}</h2>
                <p>${post.postDescription}</p>
                <button class="btn viewPostButton text-white mt-2" data-id="${post.ID}">View Post</button>
            </div>
        `).join("");

        // âœ… Add navigation logic for "View Post"
        document.querySelectorAll(".viewPostButton").forEach(button => {
            button.addEventListener("click", () => {
                const postID = button.getAttribute("data-id");
                localStorage.setItem("currentPostID", postID);
                window.location.href = "DedicatedPage.html";
            });
        });
    } catch (err) {
        console.error(err);
        postsContainer.innerHTML = "<p class='text-danger'>Error loading your posts.</p>";
    }
});
</script>

